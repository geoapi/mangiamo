<div ng-controller="mainController" ng-init="initialize()">
	<!-- Map -->
	<div id="mapContainer" class="col-xs-12">
		<input id="pac-input" class="controls" type="text" placeholder="Search Box">
		<div id="mapCanvas"></div>
	</div>

	<!-- Sidebar -->
	<div id="sidebarContainer" class="col-xs-12 col-sm-4 col-md-3 col-lg-3" ng-show="sidebarVisible">
		<!-- Close Sidebar "X" -->
		<button type="button" id="closeSidebar" class="close hidden-sm hidden-md hidden-lg" ng-click="toggleSidebar('false')">
			<span aria-hidden="true" class="pull-right"> x </span>
			<span class="sr-only"> Close </span>
		</button>

		<!-- Recommended Meals -->
		<div id="recomContainer" ng-init="initRecomMeals()" ng-show="recomVisible">
			<div class="sidebarTitle">
				Recommended
			</div>
			<hr>
			<div ng-repeat="mealSuggestion in dataBase | orderBy:'numPeople'" class="recomMeal" ng-click="goToMeal(mealSuggestion.key)">
				<div class="pull-left recomMealImageDiv">
					<img src="{{mealSuggestion.imgURL}}">
				</div>
				<div class="pull-left recomMealInfo">
					<span class="recomMealTitle">{{mealSuggestion.name}}</span>
					<br>
					<span> # attending at ##:## #M (tomorrow)</span>
				</div>
				<!-- other info -->
			</div>
		</div>

		<!-- User Instructions -->
		<div id="introContainer" ng-show="introVisible">
			<div class="sidebarTitle">
				Help
			</div>
			<hr>
			<div>
				<div>
					<span class="glyphicon glyphicon-search"></span>
					 Use the search box to find restaurants.
				</div>
				<div>
				<span class="glyphicon glyphicon-hand-up"></span>
					 Click a pin or marker on the map.
				</div>
				<div>
					<span class="glyphicon glyphicon-cutlery"></span>
					 Create or join a meal.
				</div>
				<div>
					<span class="glyphicon glyphicon-user"></span>
					 Press "Links" tab to add friends.
				 </div>
			</div>
			<!-- <h1> Legend </h1> -->
			<img src="/img/legend.png" id="legend">
		</div>

		<!-- Links -->
		<div id="linksContainer"  ng-show="linksVisible">

			<div ng-hide="isUserInDatabase()">
				<div class="sidebarTitle"> Links </div>
				<hr>
				<div id="sidebarContentHeader">
					<div ng-hide="isUserLoggedIn()">
						Please Log In with Facebook Find and Add Links!
					</div>
					<div ng-show="isUserLoggedIn()">
						<button type="button" class="btn btn-block btn-default button" data-toggle="modal" data-target="#userInformationModal">
							Just One More Step
						</button>
					</div>
				</div>
			</div>
			<div ng-show="isUserInDatabase()">
				<div class="sidebarTitle"> Links </div>
				<hr>
				<accordion close-others="true">
					<accordion-group class="accordionInfo" is-open="status.open" ng-repeat="mealBuddy in mealBuddies">
						<accordion-heading>
							{{mealBuddy[0].name}}
							<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i>
						</accordion-heading>
						<div class="mealAttendee">
							I am a <strong>{{mealBuddy[0].description}}</strong> with a profession in
							<strong>{{mealBuddy[0].profession}}</strong> and I am between
							<strong>{{mealBuddy[0].ageRange}}</strong>.
						</div>
						<button class="btn btn-default btn-sm pull-right" ng-click="removeMealBuddy(mealBuddy, false)"> Remove </button>
					</accordion-group>
					<accordion-group class="accordionInfo" id="addANewFriend">
							<!-- Add a New Friend -->
							<accordion-heading>
							<em> Add a New Friend! </em>
							<i class="pull-right glyphicon glyphicon-plus"></i>
							</accordion-heading>
								<span> 
									Your ID is: <strong>{{UID}}</strong>
									<br>
									Give it to a friend for them to add you! 
								</span>
							<form>
								<input type="text" placeholder="Enter a friend's ID" ng-model="newMealBuddy"><br>
								<button id="friendAdder" class="btn btn-primary" ng-click="addFriend(newMealBuddy)"> Click to add a Friend! </button>
							</form>
						</accordion-group>
				</accordion>

				<p class="linkHeader"> Requests </p>
				<accordion close-others="true">
					<accordion-group class="accordionInfo" is-open="status.open" ng-repeat="mealBuddyRequest in mealBuddyRequests">
						<accordion-heading>
							{{mealBuddyRequest[0].name}}
							<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i>
						</accordion-heading>
						I am a <strong>{{mealBuddyRequest[0].description}}</strong> with a profession in
						<strong>{{mealBuddyRequest[0].profession}}</strong> and I am between
						<strong>{{mealBuddyRequest[0].ageRange}}</strong>.
						<button class="btn btn-default btn-sm" ng-click="confirmMealBuddy(mealBuddyRequest)"> Accept </button>
						<button class="btn btn-default btn-sm" ng-click="removeMealBuddy(mealBuddyRequest)"> Decline </button>

					</accordion-group>
				</accordion>

				<p class="linkHeader"> Suggested Links </p>
				<button class="btn btn-default btn-sm" ng-click="loadSuggestions()" ng-disabled="findingFriends"> Find Facebook Friends </button>
				<accordion close-others="true">
					<accordion-group class="accordionInfo" is-open="status.open" ng-repeat="mealBuddySuggestion in mealBuddySuggestions">
						<accordion-heading>
							{{mealBuddySuggestion[0].name}}
							<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i>
						</accordion-heading>
						Age Range: {{mealBuddySuggestion[0].ageRange}}<br>
						Profession: {{mealBuddySuggestion[0].profession}}<br>
						Me-Factor: {{mealBuddySuggestion[0].description}}<br>
						<button class="btn btn-default btn-sm" ng-click="addFriendFromFacebookID(mealBuddySuggestion[0].facebookID)"> Add </button>
					</accordion-group>
				</accordion>
			</div>
		</div>

		<!-- Meal Information -->
		<div id="mealsContainer" ng-show="mealsVisible">
			<!-- Location -->
			<div id="mealPlace">
				<div id="mealsFullTop">
					<div class="sidebarMealsTitle">
						{{currentPin.name}}
					</div>
					<!-- <img ng-src="{{currentPin.place.photos[0].getUrl({'maxwidth': 350, 'maxHeight': 350})}}" class="mealImage hidden-xs"> -->
					<img ng-src="{{currentPin.placeImgUrl}}" class="mealImage hidden-xs">
				</div>
				<hr>
				<!-- Existing Meals -->
				<div id="mealsHeader" ng-hide="noMeals">
					<span class="pull-left"> Meal Time </span>
					Attendees
					<span class="pull-right"> Info </span>
				</div>
				<accordion close-others="true">
					<accordion-group class="accordionInfo" is-open="status.open" ng-repeat="meal in currentPin.meals | orderBy:'time'">
						<accordion-heading>
							<div id="mealInfoHeader">
								<div>
									{{meal.attendees.length}}
								</div>
								{{meal.time}}
								<i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.open, 'glyphicon-chevron-right': !status.open}"></i>
							</div>
						</accordion-heading>
						<div ng-repeat="attendee in meal.attendees" ng-init="isUserAttendingMeal(meal)">
							<div class="mealAttendee" ng-class="{mealAttendeeSelf: isThisMe(attendee)}">
								<div class="attendeeIdentifer" ng-show="isThisMe(attendee)">- This is You! -</div>
								<div class="attendeeIdentifer" ng-show="isThisMyFriend(attendee)">- {{ attendee.name }} -</div>
								I am a <strong>{{attendee.description}}</strong> with a profession in
								<strong>{{attendee.profession}}</strong> and I am between
								<strong>{{attendee.ageRange}}</strong>.
							</div>
						</div>
						<button class="btn btn-block btn-default button" ng-click="joinMeal(meal)" ng-hide="meal.attendingMeal"> Join Meal </button>
						<button class="btn btn-block btn-danger" ng-click="leaveMeal(meal)" ng-show="meal.attendingMeal"> Leave Meal </button>
					</accordion-group>
					<accordion-group class="accordionInfo" ng-hide="noMeals">
						<!-- Create Meal -->
						<accordion-heading>
							<div id="mealInfoHeader">
								<div>
									--
								</div>
								--:--
								<i class="pull-right glyphicon glyphicon-plus"></i>
							</div>
						</accordion-heading>
						<div id="timeTicker">
							<timepicker id="mealTimePicker" ng-model="mealTime" hour-step="1" minute-step="15" show-meridian="true" readonly-input="true"></timepicker>
						</div>
						<button id="createMealButton" class="btn btn-block btn-default button" ng-click="createMeal(mealTime)"> Create a New Meal </button>
					</accordion-group>
				</accordion>
				<div id="createMealContainer" ng-show="noMeals">
					<div id="sidebarContentHeader">
						Be the First to Create a Meal Here!
					</div>
					<div id="timeTicker">
						<timepicker id="mealTimePicker" ng-model="mealTime" hour-step="1" minute-step="15" show-meridian="true" readonly-input="true"></timepicker>
					</div>

					<button id="createMealButton" class="btn btn-block btn-default button" ng-click="createMeal(mealTime)"> Create a New Meal </button>
				</div>
			</div>
		</div>
	</div>
</div>
